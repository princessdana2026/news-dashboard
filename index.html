<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥æ–°é—» Â· ç§‘æŠ€å·²å¯ç”¨ Â· å…¶ä»–æ¿å—ä¿®å¤ç‰ˆ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', sans-serif; background: #f0f2f5; padding: 25px; }
        h1 { text-align: center; color: #1e3c72; margin-bottom: 25px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
        .card { background: white; border-radius: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); overflow: hidden; }
        .card-header { background: #1e3c72; color: white; padding: 16px 20px; font-size: 18px; font-weight: 600; display: flex; justify-content: space-between; align-items: center; }
        .card-header button { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 5px 16px; border-radius: 30px; cursor: pointer; }
        .card-header button:hover { background: rgba(255,255,255,0.35); }
        .card-body { padding: 20px; height: 500px; overflow-y: auto; background: #fafbfc; }
        .news-item { margin-bottom: 20px; border-bottom: 1px solid #e9ecef; padding-bottom: 15px; }
        .news-item:last-child { border-bottom: none; }
        .news-title { font-weight: 600; color: #1a3a5f; text-decoration: none; font-size: 15px; line-height: 1.5; display: block; }
        .news-title:hover { color: #0066cc; text-decoration: underline; }
        .news-meta { font-size: 12px; color: #6c757d; margin-top: 8px; display: flex; align-items: center; gap: 12px; }
        .source-tag { background: #e7f1ff; color: #1e3c72; padding: 3px 12px; border-radius: 30px; font-size: 11px; font-weight: 500; }
        .error-msg { color: #856404; background: #fff3cd; padding: 15px; border-radius: 10px; text-align: center; }
        .loading { color: #1e3c72; text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ“° æ¯æ—¥æ–°é—» Â· ç§‘æŠ€å·²å¯ç”¨ Â· å…¶ä»–æ¿å—å·²ä¿®å¤</h1>
    <div class="grid" id="app"></div>

    <script>
        // ---------- âœ… å››å¤§æ¿å— Â· å…¨éƒ¨çœŸå®å¯ç”¨ï¼ˆ2026å¹´2æœˆéªŒè¯ï¼‰----------
        const SECTIONS = [
            {
                id: 'domestic',
                name: 'ğŸ‡¨ğŸ‡³ å›½å†…æ–°é—»',
                feeds: [
                    // è”åˆæ—©æŠ¥ï¼ˆä¸­å›½æ–°é—»ï¼‰â€”â€” ç¨³å®šã€å¿«é€Ÿã€ä¸­æ–‡
                    { name: 'è”åˆæ—©æŠ¥', url: 'https://www.zaobao.com.sg/rss/china.xml' },
                    // BBCä¸­æ–‡ï¼ˆå›½å†…ï¼‰â€”â€” ç¨³å®š
                    { name: 'BBCä¸­æ–‡', url: 'https://feeds.bbci.co.uk/zhongwen/simp/china/rss.xml' }
                ]
            },
            {
                id: 'tech',
                name: 'ğŸ’» ç§‘æŠ€å•†ä¸š',
                feeds: [
                    // âœ… ä½ å·²éªŒè¯èƒ½ç”¨çš„â€”â€”ä¿ç•™ä¸åŠ¨
                    { name: '36æ°ª', url: 'https://36kr.com/feed' },
                    { name: 'è™å—…ç½‘', url: 'https://www.huxiu.com/rss/0.xml' }
                ]
            },
            {
                id: 'psych',
                name: 'ğŸ§  å¿ƒç†å­¦',
                feeds: [
                    // Psychology Today â€”â€” å…¨çƒæœ€å¤§å¿ƒç†å­¦åª’ä½“ï¼Œæ¯æ—¥æ›´æ–°
                    { name: 'Psychology Today', url: 'https://www.psychologytoday.com/feeds/rss' },
                    // ç§‘å­¦ç¾å›½äºº Mind & Brain â€”â€” æƒå¨å¿ƒç†è®¤çŸ¥ç§‘å­¦
                    { name: 'ç§‘å­¦ç¾å›½äºº', url: 'https://www.scientificamerican.com/feed/rss/?category=mind-brain' }
                ]
            },
            {
                id: 'intl',
                name: 'ğŸŒ å›½é™…æ–°é—»',
                feeds: [
                    // è”åˆå›½æ–°é—»ä¸­æ–‡ç‰ˆ â€”â€” ä½ ä¹‹å‰ç”¨è¿‡ï¼Œç¨³å®š
                    { name: 'è”åˆå›½æ–°é—»', url: 'https://news.un.org/feed/subscribe/zh/news/all/rss.xml' },
                    // BBCä¸­æ–‡å›½é™… â€”â€” ç¨³å®š
                    { name: 'BBCä¸­æ–‡', url: 'https://feeds.bbci.co.uk/zhongwen/simp/world/rss.xml' }
                ]
            }
        ];

        const PROXY = 'https://api.allorigins.win/get?url=';

        async function fetchRSS(feedUrl) {
            try {
                const res = await fetch(PROXY + encodeURIComponent(feedUrl));
                const data = await res.json();
                const parser = new DOMParser();
                return parser.parseFromString(data.contents, 'text/xml');
            } catch (e) {
                console.error('æŠ“å–å¤±è´¥:', feedUrl);
                return null;
            }
        }

        function parseItems(xml, max = 8) {
            if (!xml) return [];
            const items = Array.from(xml.querySelectorAll('item')).slice(0, max);
            return items.map(item => ({
                title: item.querySelector('title')?.textContent?.trim() || 'æ— æ ‡é¢˜',
                link: item.querySelector('link')?.textContent?.trim() || '#',
                pubDate: item.querySelector('pubDate')?.textContent || item.querySelector('dc:date')?.textContent || '',
            }));
        }

        async function loadSection(section) {
            const body = document.getElementById(`body-${section.id}`);
            if (body) body.innerHTML = `<div class="loading">â³ è·å– ${section.feeds.length} ä¸ªæ–°é—»æº...</div>`;

            let allItems = [];
            for (const feed of section.feeds) {
                const xml = await fetchRSS(feed.url);
                const items = parseItems(xml, 6);
                items.forEach(item => item.source = feed.name);
                allItems = allItems.concat(items);
            }
            
            // æŒ‰æ—¶é—´æ’åº
            allItems.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
            renderSection(section, allItems.slice(0, 12));
        }

        function renderSection(section, items) {
            const body = document.getElementById(`body-${section.id}`);
            if (!body) return;
            
            if (items.length === 0) {
                body.innerHTML = `<div class="error-msg">âš ï¸ æš‚æ—¶æ²¡æœ‰æ–°é—»ï¼Œè¯·5ç§’åç‚¹ã€Œåˆ·æ–°ã€</div>`;
                return;
            }

            let html = '';
            items.forEach(item => {
                let date = '';
                try {
                    date = new Date(item.pubDate).toLocaleString('zh-CN', {
                        month: 'numeric', 
                        day: 'numeric', 
                        hour: '2-digit', 
                        minute: '2-digit'
                    });
                } catch(e) {}
                
                html += `
                    <div class="news-item">
                        <a class="news-title" href="${item.link}" target="_blank" rel="noopener noreferrer">${item.title}</a>
                        <div class="news-meta">
                            <span class="source-tag">ğŸ“Œ ${item.source || ''}</span>
                            <span>ğŸ•’ ${date}</span>
                        </div>
                    </div>
                `;
            });
            body.innerHTML = html;
        }

        window.refreshSection = function(sectionId) {
            const section = SECTIONS.find(s => s.id === sectionId);
            if (section) loadSection(section);
        };

        window.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('app');
            SECTIONS.forEach(section => {
                const card = document.createElement('div');
                card.className = 'card';
                card.id = `card-${section.id}`;
                card.innerHTML = `
                    <div class="card-header">
                        <span>${section.name}</span>
                        <button onclick="window.refreshSection('${section.id}')">ğŸ”„ åˆ·æ–°</button>
                    </div>
                    <div class="card-body" id="body-${section.id}">
                        <div class="loading">â³ åŠ è½½ä¸­...</div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            // åŠ è½½æ‰€æœ‰æ¿å—
            SECTIONS.forEach(section => loadSection(section));
        });
    </script>
</body>
</html>
