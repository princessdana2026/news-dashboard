<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥æ–°é—» Â· å›½å†…ç›´è¿ç‰ˆ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Microsoft YaHei', sans-serif; background: #f0f2f5; padding: 25px; }
        h1 { text-align: center; color: #1e3c72; margin-bottom: 10px; font-size: 28px; }
        .sub { text-align: center; color: #6c757d; margin-bottom: 30px; font-size: 14px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 25px; }
        .card { background: white; border-radius: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); overflow: hidden; }
        .card-header { background: #1e3c72; color: white; padding: 16px 20px; font-size: 18px; font-weight: 600; display: flex; justify-content: space-between; align-items: center; }
        .card-header button { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 5px 16px; border-radius: 30px; cursor: pointer; }
        .card-header button:hover { background: rgba(255,255,255,0.35); }
        .card-body { padding: 20px; height: 600px; overflow-y: auto; background: #fafbfc; }
        .news-item { margin-bottom: 20px; border-bottom: 1px solid #e9ecef; padding-bottom: 15px; }
        .news-item:last-child { border-bottom: none; }
        .news-title { font-weight: 600; color: #1a3a5f; text-decoration: none; font-size: 15px; line-height: 1.5; display: block; }
        .news-title:hover { color: #0066cc; text-decoration: underline; }
        .news-meta { font-size: 12px; color: #6c757d; margin-top: 8px; display: flex; align-items: center; gap: 12px; }
        .source-tag { background: #e7f1ff; color: #1e3c72; padding: 3px 12px; border-radius: 30px; font-size: 11px; font-weight: 500; }
        .error-msg { color: #856404; background: #fff3cd; padding: 15px; border-radius: 10px; text-align: center; }
        .loading { color: #1e3c72; text-align: center; padding: 20px; }
    </style>
</head>
<body>
    <h1>ğŸ“° æ¯æ—¥æ–°é—» Â· å›½å†…ç›´è¿ç‰ˆ</h1>
    <div class="sub">âœ… çŸ¥ä¹æ¯æ—¥ç²¾é€‰ Â· æ— éœ€ä»£ç† Â· å®æ—¶æ›´æ–°</div>
    <div class="grid" id="app"></div>

    <script>
        // ---------- å››å¤§æ¿å— Â· å…¨éƒ¨ä½¿ç”¨çŸ¥ä¹æ¯æ—¥ç²¾é€‰ï¼ˆå›½å†…ç›´è¿ï¼‰----------
        const SECTIONS = [
            {
                id: 'tech',
                name: 'ğŸ’» ç§‘æŠ€å¤´æ¡',
                // çŸ¥ä¹ã€Œç§‘æŠ€ã€è¯é¢˜æ¯æ—¥ç²¾é€‰
                api: 'https://www.zhihu.com/api/v4/topics/19566034/feeds?limit=20',
                sourceName: 'çŸ¥ä¹ç§‘æŠ€'
            },
            {
                id: 'domestic',
                name: 'ğŸ‡¨ğŸ‡³ å›½å†…æ–°é—»',
                // çŸ¥ä¹ã€Œæ–°é—»ã€è¯é¢˜æ¯æ—¥ç²¾é€‰
                api: 'https://www.zhihu.com/api/v4/topics/19550517/feeds?limit=20',
                sourceName: 'çŸ¥ä¹æ–°é—»'
            },
            {
                id: 'intl',
                name: 'ğŸŒ å›½é™…æ–°é—»',
                // çŸ¥ä¹ã€Œå›½é™…ã€è¯é¢˜æ¯æ—¥ç²¾é€‰
                api: 'https://www.zhihu.com/api/v4/topics/19555654/feeds?limit=20',
                sourceName: 'çŸ¥ä¹å›½é™…'
            },
            {
                id: 'psych',
                name: 'ğŸ§  å¿ƒç†å­¦',
                // çŸ¥ä¹ã€Œå¿ƒç†å­¦ã€è¯é¢˜æ¯æ—¥ç²¾é€‰
                api: 'https://www.zhihu.com/api/v4/topics/19550731/feeds?limit=20',
                sourceName: 'çŸ¥ä¹å¿ƒç†'
            }
        ];

        // ---------- ç›´æ¥ä»çŸ¥ä¹APIè·å–æ•°æ®ï¼ˆå›½å†…ç›´è¿ï¼Œä¸éœ€è¦ä»£ç†ï¼‰----------
        async function fetchZhihu(apiUrl) {
            try {
                const res = await fetch(apiUrl);
                const data = await res.json();
                return data.data || [];
            } catch (e) {
                console.error('çŸ¥ä¹æŠ“å–å¤±è´¥:', e);
                return [];
            }
        }

        // ---------- è§£æçŸ¥ä¹æ•°æ®ä¸ºæ–°é—»æ¡ç›® ----------
        function parseZhihuItems(items, max = 20) {
            return items.slice(0, max).map(item => {
                // çŸ¥ä¹APIè¿”å›çš„å†…å®¹ç»“æ„
                const target = item.target || {};
                return {
                    title: target.title || target.question?.title || 'æ— æ ‡é¢˜',
                    link: `https://www.zhihu.com/question/${target.question?.id || target.id}`,
                    pubDate: item.updated_time || item.created_time || Date.now(),
                };
            });
        }

        async function loadSection(section) {
            const body = document.getElementById(`body-${section.id}`);
            if (body) body.innerHTML = `<div class="loading">â³ è·å–æœ€æ–° ${section.sourceName} å¤´æ¡...</div>`;

            const items = await fetchZhihu(section.api);
            const newsItems = parseZhihuItems(items, 20);
            
            if (body) {
                if (newsItems.length === 0) {
                    body.innerHTML = `<div class="error-msg">â³ æ­£åœ¨è¿æ¥ï¼Œè¯·ç‚¹åˆ·æ–°</div>`;
                } else {
                    let html = '';
                    newsItems.forEach(item => {
                        let date = '';
                        try {
                            date = new Date(item.pubDate * 1000).toLocaleString('zh-CN', {
                                month: 'numeric', day: 'numeric', 
                                hour: '2-digit', minute: '2-digit'
                            });
                        } catch(e) {}
                        
                        html += `
                            <div class="news-item">
                                <a class="news-title" href="${item.link}" target="_blank">${item.title}</a>
                                <div class="news-meta">
                                    <span class="source-tag">ğŸ“Œ ${section.sourceName}</span>
                                    <span>ğŸ•’ ${date}</span>
                                </div>
                            </div>
                        `;
                    });
                    body.innerHTML = html;
                }
            }
        }

        window.refreshSection = function(sectionId) {
            const section = SECTIONS.find(s => s.id === sectionId);
            if (section) loadSection(section);
        };

        window.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('app');
            SECTIONS.forEach(section => {
                const card = document.createElement('div');
                card.className = 'card';
                card.id = `card-${section.id}`;
                card.innerHTML = `
                    <div class="card-header">
                        <span>${section.name}</span>
                        <button onclick="window.refreshSection('${section.id}')">ğŸ”„ åˆ·æ–°</button>
                    </div>
                    <div class="card-body" id="body-${section.id}">
                        <div class="loading">â³ åŠ è½½ä¸­...</div>
                    </div>
                `;
                container.appendChild(card);
            });
            
            // åŒæ—¶åŠ è½½æ‰€æœ‰æ¿å—
            SECTIONS.forEach(section => loadSection(section));
        });
    </script>
</body>
</html>
